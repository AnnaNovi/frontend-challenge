(function(){"use strict";var t={7157:function(t,e,a){var r=a(9242),o=a(3396);const n=(0,o.Uk)("Все котики"),i=(0,o.Uk)("Любимые котики");function s(t,e){const a=(0,o.up)("router-link"),r=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("nav",null,[(0,o.Wm)(a,{to:"/"},{default:(0,o.w5)((()=>[n])),_:1}),(0,o.Wm)(a,{to:"/favorite"},{default:(0,o.w5)((()=>[i])),_:1})]),(0,o.Wm)(r)],64)}var l=a(89);const c={},u=(0,l.Z)(c,[["render",s]]);var d=u,f=a(678),v=a(7139);function m(t,e,a,n,i,s){const l=(0,o.up)("CatCard"),c=(0,o.up)("CatBlock");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.allCats,(e=>((0,o.wg)(),(0,o.j4)(l,{key:e.id,cat:e,onImageLoaded:t.whenImageLoaded},null,8,["cat","onImageLoaded"])))),128))])),_:1}),(0,o.wy)((0,o._)("div",{class:(0,v.C_)(t.$style.loadMore),ref:"loadMoreCats"}," ... загружаем еще котиков ... ",2),[[r.F8,t.isImagesLoaded]])])}var C=a(65),g=a(4104),h=a(7842),p=(0,o.aZ)({name:"HomeView",data(){return{quantityOfLoadedImages:0,isImagesLoaded:!1}},components:{CatCard:g.Z,CatBlock:h.Z},computed:{...(0,C.Se)(["allCats","allCatsSize","allCatsLimit"])},watch:{quantityOfLoadedImages(){const t=this.allCatsSize>this.allCatsLimit?this.allCatsSize-2*this.allCatsLimit/3:this.allCatsLimit/3;this.quantityOfLoadedImages>=Math.round(t)?this.isImagesLoaded=!0:this.isImagesLoaded=!1},isImagesLoaded(){this.isImagesLoaded&&this.loadMoreCats()}},methods:{...(0,C.nv)(["getAllCats","getNextPage"]),loadMoreCats(){const t=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.isIntersecting&&setTimeout((()=>{this.getNextPage(),e.unobserve(t.target)}),1e3)}))})),e=this.$refs["loadMoreCats"];t.observe(e)},whenImageLoaded(){this.quantityOfLoadedImages+=1}},mounted(){this.getAllCats()}}),_={loadMore:"HomeView_loadMore_Wzbo0"};const y={};y["$style"]=_;const b=(0,l.Z)(p,[["render",m],["__cssModules",y]]);var L=b;const A=[{path:"/",name:"home",component:L},{path:"/favorite",name:"favorite",component:()=>a.e(430).then(a.bind(a,6206))}],E=(0,f.p7)({history:(0,f.r5)(),routes:A}),O={state:()=>({favoritesCats:new Map}),getters:{favoritesCats(t){const e=t.favoritesCats.entries(),a=[];for(const r of e){const[t,{categorieName:e,url:o}]=r,n={id:t,categorieName:e,url:o};a.push(n)}if(a.length)return a},favoritesCatsSize(t){return t.favoritesCats.size}},mutations:{ADD_FAVORITE_CAT(t,e){return t.favoritesCats.set(e.id,{categorieName:e.categorieName,url:e.url})},REMOVE_FAVORITE_CAT(t,e){return t.favoritesCats.delete(e)},SET_FAVORITE_CATS_FROM_LOCALSTORAGE(t,e){const a=JSON.parse(e);return t.favoritesCats=new Map(a)}},actions:{addFavoriteCat({commit:t},e){t("ADD_FAVORITE_CAT",e)},removeFavoriteCat({commit:t},e){t("REMOVE_FAVORITE_CAT",e)},toggleFavoriteCat({state:t,dispatch:e},a){const r=t.favoritesCats.has(a.id);r?e("removeFavoriteCat",a.id):e("addFavoriteCat",a),localStorage.setItem("favoriteCatsList",JSON.stringify([...t.favoritesCats]))},checkFavoriteCat({state:t},e){return t.favoritesCats.has(e)},getFavoriteCatsFromLocalStorage({commit:t}){const e=localStorage.getItem("favoriteCatsList");e&&t("SET_FAVORITE_CATS_FROM_LOCALSTORAGE",e)}}},w={state:()=>({allCats:[],allCatsPage:0,allCatsLimit:15}),getters:{allCats(t){return t.allCats},allCatsSize(t){return t.allCats.length},allCatsLimit(t){return t.allCatsLimit}},mutations:{SET_CATS(t,e){return t.allCats=[...t.allCats,...e]},INCREASE_PAGE(t){return t.allCatsPage+=1}},actions:{async getAllCats({commit:t,state:e},a=!1){a||(e.allCats.length=0);const r=e.allCatsLimit,o=e.allCatsPage;await fetch(`https://api.thecatapi.com/v1/images/search?size=small&format=json&limit=${r}&page=${o}`,{headers:{["x-api-key"]:{NODE_ENV:"production",BASE_URL:"dist/"}.THE_CAT_API}}).then((t=>t.json())).then((e=>{const a=e.map((t=>({id:t.id,categorieName:t.categories?t.categories[0].name:null,url:t.url})));t("SET_CATS",a)})).catch((t=>{console.log(t)}))},getNextPage({commit:t,dispatch:e}){t("INCREASE_PAGE"),e("getAllCats",!0)}}};var I=(0,C.MT)({modules:{favoritesCats:O,allCats:w}});(0,r.ri)(d).use(I).use(E).mount("#app")},7842:function(t,e,a){a.d(e,{Z:function(){return d}});var r=a(3396),o=a(7139);function n(t,e,a,n,i,s){return(0,r.wg)(),(0,r.iD)("div",{class:(0,o.C_)(t.$style.catsBlock)},[(0,r.WI)(t.$slots,"default")],2)}var i=(0,r.aZ)({name:"CatBlock"}),s={catsBlock:"CatBlock_catsBlock_HMkir"},l=a(89);const c={};c["$style"]=s;const u=(0,l.Z)(i,[["render",n],["__cssModules",c]]);var d=u},4104:function(t,e,a){a.d(e,{Z:function(){return m}});var r=a(3396),o=a(7139);const n=(0,r._)("svg",{viewBox:"0 -6 40 50"},[(0,r._)("path",{d:"M20 36.7L17.1 34.06C6.8 24.72 0 18.56 0 11C0 4.84 4.84 0 11 0C14.48 0 17.82 1.62 20 4.18C22.18 1.62 25.52 0 29 0C35.16 0 40 4.84 40 11C40 18.56 33.2 24.72 22.9 34.08L20 36.7Z"})],-1),i=[n];function s(t,e,a,n,s,l){return(0,r.wg)(),(0,r.iD)("div",{class:(0,o.C_)(t.$style.catCard)},[(0,r._)("img",{class:(0,o.C_)(t.$style.image),ref:"catImage",alt:"Cat image",onLoad:e[0]||(e[0]=e=>t.$emit("imageLoaded"))},null,34),(0,r._)("div",{class:(0,o.C_)([t.$style.favorite,{[t.$style.activeFavorite]:this.favorite}]),onClick:e[1]||(e[1]=(...e)=>t.handleFavoriteButton&&t.handleFavoriteButton(...e))},i,2)],2)}var l=a(65),c=(0,r.aZ)({name:"CatCard",data(){return{favorite:!1}},props:{cat:{type:Object}},methods:{...(0,l.nv)(["checkFavoriteCat","toggleFavoriteCat"]),handleFavoriteButton(){this.toggleFavoriteCat(this.cat),this.favorite=!this.favorite},lazyImageLoad(){const t=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.isIntersecting&&(t.target.src=this.cat?.url,e.unobserve(t.target))}))}),{rootMargin:"300px 0px 0px"}),e=this.$refs["catImage"];t.observe(e)}},mounted(){this.checkFavoriteCat(this.cat?.id).then((t=>{this.favorite=t})),this.lazyImageLoad()}}),u={image:"CatCard_image_GJnT2",catCard:"CatCard_catCard_ml1cy",favorite:"CatCard_favorite_ghHKc",activeFavorite:"CatCard_activeFavorite_GBqih"},d=a(89);const f={};f["$style"]=u;const v=(0,d.Z)(c,[["render",s],["__cssModules",f]]);var m=v}},e={};function a(r){var o=e[r];if(void 0!==o)return o.exports;var n=e[r]={exports:{}};return t[r](n,n.exports,a),n.exports}a.m=t,function(){var t=[];a.O=function(e,r,o,n){if(!r){var i=1/0;for(u=0;u<t.length;u++){r=t[u][0],o=t[u][1],n=t[u][2];for(var s=!0,l=0;l<r.length;l++)(!1&n||i>=n)&&Object.keys(a.O).every((function(t){return a.O[t](r[l])}))?r.splice(l--,1):(s=!1,n<i&&(i=n));if(s){t.splice(u--,1);var c=o();void 0!==c&&(e=c)}}return e}n=n||0;for(var u=t.length;u>0&&t[u-1][2]>n;u--)t[u]=t[u-1];t[u]=[r,o,n]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var r in e)a.o(e,r)&&!a.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){a.f={},a.e=function(t){return Promise.all(Object.keys(a.f).reduce((function(e,r){return a.f[r](t,e),e}),[]))}}(),function(){a.u=function(t){return"js/favorite.e2d23e18.js"}}(),function(){a.miniCssF=function(t){return"css/favorite.4bf5ca09.css"}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="uchi-ru:";a.l=function(r,o,n,i){if(t[r])t[r].push(o);else{var s,l;if(void 0!==n)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==e+n){s=d;break}}s||(l=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,a.nc&&s.setAttribute("nonce",a.nc),s.setAttribute("data-webpack",e+n),s.src=r),t[r]=[o];var f=function(e,a){s.onerror=s.onload=null,clearTimeout(v);var o=t[r];if(delete t[r],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((function(t){return t(a)})),e)return e(a)},v=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),l&&document.head.appendChild(s)}}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){a.p="dist/"}(),function(){var t=function(t,e,a,r){var o=document.createElement("link");o.rel="stylesheet",o.type="text/css";var n=function(n){if(o.onerror=o.onload=null,"load"===n.type)a();else{var i=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.href||e,l=new Error("Loading CSS chunk "+t+" failed.\n("+s+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=i,l.request=s,o.parentNode.removeChild(o),r(l)}};return o.onerror=o.onload=n,o.href=e,document.head.appendChild(o),o},e=function(t,e){for(var a=document.getElementsByTagName("link"),r=0;r<a.length;r++){var o=a[r],n=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(n===t||n===e))return o}var i=document.getElementsByTagName("style");for(r=0;r<i.length;r++){o=i[r],n=o.getAttribute("data-href");if(n===t||n===e)return o}},r=function(r){return new Promise((function(o,n){var i=a.miniCssF(r),s=a.p+i;if(e(i,s))return o();t(r,s,o,n)}))},o={143:0};a.f.miniCss=function(t,e){var a={430:1};o[t]?e.push(o[t]):0!==o[t]&&a[t]&&e.push(o[t]=r(t).then((function(){o[t]=0}),(function(e){throw delete o[t],e})))}}(),function(){var t={143:0};a.f.j=function(e,r){var o=a.o(t,e)?t[e]:void 0;if(0!==o)if(o)r.push(o[2]);else{var n=new Promise((function(a,r){o=t[e]=[a,r]}));r.push(o[2]=n);var i=a.p+a.u(e),s=new Error,l=function(r){if(a.o(t,e)&&(o=t[e],0!==o&&(t[e]=void 0),o)){var n=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;s.message="Loading chunk "+e+" failed.\n("+n+": "+i+")",s.name="ChunkLoadError",s.type=n,s.request=i,o[1](s)}};a.l(i,l,"chunk-"+e,e)}},a.O.j=function(e){return 0===t[e]};var e=function(e,r){var o,n,i=r[0],s=r[1],l=r[2],c=0;if(i.some((function(e){return 0!==t[e]}))){for(o in s)a.o(s,o)&&(a.m[o]=s[o]);if(l)var u=l(a)}for(e&&e(r);c<i.length;c++)n=i[c],a.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return a.O(u)},r=self["webpackChunkuchi_ru"]=self["webpackChunkuchi_ru"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=a.O(void 0,[998],(function(){return a(7157)}));r=a.O(r)})();
//# sourceMappingURL=app.60c8472d.js.map